<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>分页查询</title>
 </head>
 <body onload="loadUser(1)">   <!--初始值-->
	<table border="1px" align="center" width="800px">
		<thead>
			<tr bgcolor="yellow">
				<th>登录名称</th>
				<th>电子邮箱</th>
				<th>联系方式</th>
				<th>用户姓名</th>
				<th>用户性别</th>
				<th>操作</th>
			</tr>
		</thead>
		<tbody id="show-body"></tbody>
		<tfoot>
			<tr>
				<td colspan="6" id="page"></td>
			</tr>
		</tfoot>
	</table>

	<script src="public_file.js"></script>
	<script>
		function loadUser(currentPage){ //形参,表示当前的页数
			var xhr=createXhr();
			xhr.onreadystatechange=function()
			{
				if(xhr.readyState==4 && xhr.status==200)
				{
					var arr=JSON.parse(xhr.responseText);
					//console.log(arr);
					var data=arr.data;     //取代data数据
					var html="";
					for(var i=0;i<data.length;i++){   //循环遍历data了
						var user=data[i];
						html+="<tr>";
							html+="<td>"+user.uname+"</td>";
							html+="<td>"+user.email+"</td>";
							html+="<td>"+user.phone+"</td>";
							html+="<td>"+user.user_name+"</td>";
							var gender="";
							if(user.gender==1){
								gender="男";
							}else if(user.gender==0){
								gender="女";
							}else{
								gender="保密";
							}
							html+="<td>"+gender+"</td>";
							html+="<td>";
								html+="<a href='#'>删除</a>";
								html+="<a href='#'>修改</a>";
							html+="</td>";
						html+="</tr>";
					}
					$("show-body").innerHTML=html;

					//循环遍历显示的页数
					var pageHTML="";
					var page=arr.totalPage;
					for(var i=1; i<=page; i++){
						pageHTML+="<a href='javascript:loadUser("+i+")'>"+i+"</a>&nbsp;";   //实参是i
					}
					$("page").innerHTML=pageHTML;
				}
			}
			xhr.open("get","07-listPage.php?currentPage="+currentPage,true);  //currentPage,来自形参那边
			xhr.send(null);
		}
	</script>
 </body>
</html>
